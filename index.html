<!doctype html>
<html lang="en" data-theme="dark">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ROTAS</title>

<!-- PWA META -->
<meta name="theme-color" content="#020617">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="ROTAS">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icons/icon-192.png">
<!-- PWA META END -->

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg: radial-gradient(1200px 600px at top, #0f172a, #020617);
  --card: rgba(255,255,255,0.08);
  --muted:#94a3b8;
  --text:#e5e7eb;

  --accent:#22d3ee;
  --accent-2:#a78bfa;

  --day_shift: linear-gradient(135deg,#fde047,#facc15);
  --night_shift: linear-gradient(135deg,#2563eb,#1e40af);
  --holiday: linear-gradient(135deg,#34d399,#10b981);

  --border: rgba(255,255,255,0.15);
  --radius: 16px;
  font-family: Inter, system-ui;
}

/* ===== SEPIA THEME ===== */
html[data-theme="sepia"]{
  --bg: radial-gradient(1200px 600px at top, #f5efe6, #e8dcc8);
  --card: rgba(255,255,255,0.75);
  --muted:#6b5e4a;
  --text:#3b2f1e;

  --accent:#c0841a;
  --accent-2:#e0b34a;

  --border: rgba(0,0,0,0.15);
}

*{ box-sizing:border-box; }

body{
  margin:0;
  padding:14px;
  background:var(--bg);
  color:var(--text);
  transition: background .4s ease, color .4s ease;
}

/* HEADER */
.app-header{
  position:sticky;
  display:flex;
  flex-direction:column;
  gap:14px;
  top:0;
  z-index:20;
  backdrop-filter: blur(14px);
  background: linear-gradient(
    to bottom,
    rgba(2,6,23,0.9),
    rgba(2,6,23,0.55)
  );
  padding-bottom:10px;
}

html[data-theme="sepia"] .app-header{
  background: linear-gradient(
    to bottom,
    rgba(245,239,230,.9),
    rgba(245,239,230,.6)
  );
}

.teams-row,
.controls-row{
  display:flex;
  gap:10px;
  overflow-x:auto;
}

.teams-row::-webkit-scrollbar,
.controls-row::-webkit-scrollbar{
  display:none;
}

/* SEGMENTED */
.segmented{
  display:inline-flex;
  padding:4px;
  border-radius:999px;
  background:var(--card);
  border:1px solid var(--border);
}

.segmented button{
  border:0;
  background:transparent;
  padding:10px 14px;
  border-radius:999px;
  font-size:13px;
  font-weight:700;
  color:var(--muted);
  cursor:pointer;
}

.segmented button[aria-pressed="true"]{
  background:linear-gradient(135deg,var(--accent),var(--accent-2));
  color:#020617;
}

/* BUTTONS */
.btn,
input[type="number"]{
  background:var(--card);
  border:1px solid var(--border);
  color:var(--text);
  padding:10px 14px;
  border-radius:12px;
  font-size:14px;
  font-weight:600;
}

.btn:active{ transform:scale(.96); }

input[type="number"]{
  width:90px;
  text-align:center;
}

/* GRID */
.year-grid{
  margin-top:12px;
  display:grid;
  gap:14px;
}

@media(min-width:520px){ .year-grid{ grid-template-columns:repeat(2,1fr); } }
@media(min-width:760px){ .year-grid{ grid-template-columns:repeat(3,1fr); } }
@media(min-width:1024px){ .year-grid{ grid-template-columns:repeat(4,1fr); } }

/* MONTH CARD */
.month-card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:12px;
  backdrop-filter: blur(16px);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.08),
    0 20px 40px rgba(0,0,0,.35);
  animation:fadeUp .4s ease both;
}

.month-title{
  font-weight:800;
  font-size:13px;
  margin-bottom:6px;
  letter-spacing:.4px;
}

/* CALENDAR */
.calendar{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
  font-size:12px;
}

.calendar thead th{
  text-align:center;
  color:var(--muted);
  font-size:10px;
  padding-bottom:6px;
}

.calendar tbody td{
  height:34px;
  padding:4px;
  text-align:center;
}

/* DATE */
.date{
  display:flex;
  align-items:center;
  justify-content:center;
  width:28px;
  height:28px;
  border-radius:999px;
  font-size:11px;
  font-weight:700;
}

.day_shift{ background:var(--day_shift); color:#1f2933; }
.night_shift{ background:var(--night_shift); color:#fff; }
.holiday{ background:var(--holiday); color:#022c22; }

@keyframes fadeUp{
  from{ opacity:0; transform:translateY(10px); }
  to{ opacity:1; transform:none; }
}
</style>
</head>

<body>

<header class="app-header">
  <div class="teams-row">
    <div class="segmented">
      <button aria-pressed="true">WOJTEK</button>
      <button aria-pressed="false">BEN</button>
      <button aria-pressed="false">MARK</button>
      <button aria-pressed="false">ADAM</button>
    </div>
  </div>

  <div class="controls-row">
    <button id="themeToggle" class="btn">ðŸŒ™ Dark</button>
    <button id="resetBtn" class="btn">Reset</button>
    <button id="prevYear" class="btn">â—€</button>
    <input id="yearInput" type="number" />
    <button id="nextYear" class="btn">â–¶</button>
  </div>
</header>

<main>
  <div id="calendarContainer" class="year-grid"></div>
</main>

<script>
/* ========= THEME SWITCH ========= */
const themeBtn = document.getElementById("themeToggle");
const root = document.documentElement;

function setTheme(theme){
  root.setAttribute("data-theme", theme);
  localStorage.setItem("theme", theme);
  themeBtn.textContent = theme === "dark" ? "ðŸŒ™ Dark" : "â˜€ï¸ Light";
}

setTheme(localStorage.getItem("theme") || "dark");

themeBtn.onclick = () => {
  setTheme(root.getAttribute("data-theme") === "dark" ? "sepia" : "dark");
};
</script>

<script>

  const yearInput = document.getElementById('yearInput');
  const calendarContainer = document.getElementById('calendarContainer');
  const prevBtn = document.getElementById('prevYear');
  const nextBtn = document.getElementById('nextYear');
  const resetBtn = document.getElementById('resetBtn');

  const teamBtns = Array.from(document.querySelectorAll('.segmented button'));

  const SHIFT_PATTERN = [0,0,1,1,0,0,1,1,1,0,0,1,1,0,0,0,2,2,0,0,2,2,2,0,0,2,2,0];
  const TEAM_OFFSETS = [22,8,1,15];
  const MONTH_NAMES = ['January','February','March','April','May','June','July','August','September','October','November','December'];
  const WEEKDAY_NAMES_MON = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];

  const today = new Date();
  let currentYear = today.getFullYear();
  let start_index = TEAM_OFFSETS[0];
  yearInput.value = currentYear;

  prevBtn.onclick = ()=> changeYear(-1);
  nextBtn.onclick = ()=> changeYear(1);
  function setYearFromInput(){ const v = Number(yearInput.value); if (!Number.isInteger(v)){ return; } currentYear=v; renderYear(currentYear); }
      yearInput.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') setYearFromInput(); });


  resetBtn.onclick = reset;


  teamBtns.forEach((btn,i)=>{
    btn.onclick=()=>{
      teamBtns.forEach(b=>b.setAttribute('aria-pressed','false'));
      btn.setAttribute('aria-pressed','true');
      start_index = TEAM_OFFSETS[i];
      renderYear(currentYear);
    };
  });

  function changeYear(d){
    currentYear+=d;
    yearInput.value=currentYear;
    renderYear(currentYear);
  }

  function setYearFromInput(){
    currentYear=+yearInput.value;
    renderYear(currentYear);
  }

  function reset(){
    currentYear=today.getFullYear();
    yearInput.value=currentYear;
    renderYear(currentYear);
  }

  function Number_Of_Leap_Years(year){
    return Math.floor((year-1)/4)-Math.floor((year-1)/100)+Math.floor((year-1)/400)
         - (Math.floor(2023/4)-Math.floor(2023/100)+Math.floor(2023/400));
  }

  function Find_New_Shift_Index(start, year, days, len){
    if(year===2024) return start;
    let idx=(start+1)%len;
    let shift=days%len;
    return year>2024 ? (idx+shift-1+len)%len : (idx-shift-1+len)%len;
  }

  renderYear(currentYear);

  function renderYear(year){
    calendarContainer.innerHTML="";
    const stored=start_index;

    const leaps=Number_Of_Leap_Years(year);
    const days=(365*Math.abs(year-2024))+leaps;
    start_index=Find_New_Shift_Index(start_index,year,days,SHIFT_PATTERN.length);

    for(let m=0;m<12;m++){
      const card=document.createElement("section");
      card.className="month-card";

      const title=document.createElement("div");
      title.className="month-title";
      title.textContent=MONTH_NAMES[m]+" "+year;

      const table=document.createElement("table");
      table.className="calendar";

      const thead=document.createElement("thead");
      const trh=document.createElement("tr");
      WEEKDAY_NAMES_MON.forEach(d=>{
        const th=document.createElement("th");
        th.textContent=d;
        trh.appendChild(th);
      });
      thead.appendChild(trh);

      const tbody=document.createElement("tbody");
      const first=new Date(year,m,1);
      const last=new Date(year,m+1,0);
      const daysInMonth=last.getDate();
      const firstIndex=(first.getDay()+6)%7;

      let day=1;
      while(day<=daysInMonth){
        const tr=document.createElement("tr");
        for(let c=0;c<7;c++){
          const td=document.createElement("td");
          if(tbody.children.length===0 && c<firstIndex || day>daysInMonth){
            tr.appendChild(td); continue;
          }
          const sp=document.createElement("span");
          sp.className="date";
          sp.textContent=day;

          if(SHIFT_PATTERN[start_index]===1) sp.classList.add("day_shift");
          if(SHIFT_PATTERN[start_index]===2) sp.classList.add("night_shift");

          start_index=(start_index+1)%SHIFT_PATTERN.length;

          td.appendChild(sp);
          td.onclick=()=>sp.classList.toggle("holiday");
          tr.appendChild(td);
          day++;
        }
        tbody.appendChild(tr);
      }

      table.append(thead,tbody);
      card.append(title,table);
      calendarContainer.appendChild(card);
    }
    start_index=stored;
  }
;
</script>
<!-- script for registering Service Worker -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js');
  });
}
</script>

</body>
</html>
